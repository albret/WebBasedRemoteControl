use rcdb

drop table users;
drop table sessions;
drop table wsSessions;
drop table resetPassword;
drop table layouts;
drop table posts;
drop table comments;

create table users(
	id INT NOT NULL AUTO_INCREMENT UNIQUE,
	username CHAR(50) UNIQUE,
	email CHAR(100) UNIQUE,
	hash CHAR(64),
	active BOOLEAN NOT NULL DEFAULT 1,
	PRIMARY KEY (id)
);

create table sessions(
    email CHAR(50) NOT NULL,
    token CHAR(128) NOT NULL,
    expire CHAR(13) NOT NULL
);

create table wsSessions(
    email CHAR(50) NOT NULL,
    connection_key CHAR(4) NOT NULL,
    expire CHAR(13) NOT NULL
);

create table resetPassword(
    email CHAR(50) NOT NULL,
    token CHAR(64) NOT NULL,
    expire CHAR(13) NOT NULL
);

create table layouts(
    email CHAR(50) NOT NULL,
    data TEXT NOT NULL,
    id INT NOT NULL AUTO_INCREMENT UNIQUE,
    PRIMARY KEY (id)
);

create table posts(
    id INT NOT NULL UNIQUE,
    title CHAR(255),
    username CHAR(50),
    text TEXT,
    age CHAR(13),
    upvote INT NOT NULL DEFAULT 1,
    downvote INT NOT NULL DEFAULT 0,
    active BOOLEAN NOT NULL DEFAULT 1,
    PRIMARY KEY (id),
    FOREIGN KEY (id) REFERENCES layouts(id)
);

create table comments(
    id INT NOT NULL AUTO_INCREMENT UNIQUE,
    username CHAR(50),
    text TEXT,
    age CHAR(50),
    post_id INT,
    upvote INT NOT NULL DEFAULT 1,
    downvote INT NOT NULL DEFAULT 0,
    PRIMARY KEY (id),
    FOREIGN KEY (post_id) REFERENCES posts(id)
);

show tables;
